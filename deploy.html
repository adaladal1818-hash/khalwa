<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نشر بيانات الخلوة</title>
    <style>
        body { font-family: Arial; margin: 20px; background: #f5f5f5; direction: rtl; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
        textarea { width: 100%; height: 300px; margin: 10px 0; padding: 10px; }
        button { background: #27ae60; color: white; border: none; padding: 10px 20px; margin: 5px; border-radius: 5px; cursor: pointer; }
        .info { background: #e8f4fd; padding: 15px; border-radius: 5px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>📤 نشر بيانات الخلوة</h1>
        
        <div class="info">
            <h3>🔧 طريقة الاستخدام:</h3>
            <ol>
                <li>انسخ محتوى ملف data.json من تطبيق المسؤول</li>
                <li>الصق المحتوى في المربع أدناه</li>
                <li>انقر على "نسخ للذاكرة"</li>
                <li>اذهب إلى GitHub والصق المحتوى في ملف data.json</li>
            </ol>
        </div>

        <textarea id="jsonData" placeholder="الصق محتوى data.json هنا..."></textarea>
        
        <div>
            <button onclick="copyToClipboard()">📋 نسخ للذاكرة</button>
            <button onclick="loadFromLocal()">📂 جلب من التطبيق</button>
            <button onclick="clearData()">🗑️ مسح</button>
        </div>

        <div id="status" style="margin-top: 15px;"></div>
    </div>

    <script>
        function copyToClipboard() {
            const textarea = document.getElementById('jsonData');
            textarea.select();
            document.execCommand('copy');
            showStatus('✅ تم النسخ إلى الذاكرة', 'success');
        }

        function loadFromLocal() {
            try {
                const kholwaData = localStorage.getItem('kholwa');
                const historyData = localStorage.getItem('history');
                const studentsData = localStorage.getItem('students');
                
                const data = {
                    kholwa: kholwaData ? JSON.parse(kholwaData) : null,
                    history: historyData ? JSON.parse(historyData) : [],
                    lastUpdated: new Date().toISOString()
                };
                
                document.getElementById('jsonData').value = JSON.stringify(data, null, 2);
                showStatus('✅ تم جلب البيانات من التطبيق', 'success');
            } catch (error) {
                showStatus('❌ خطأ في جلب البيانات', 'error');
            }
        }

        function clearData() {
            document.getElementById('jsonData').value = '';
            showStatus('🗑️ تم مسح البيانات', 'info');
        }

        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.innerHTML = `<div style="padding: 10px; background: ${
                type === 'success' ? '#d4edda' : 
                type === 'error' ? '#f8d7da' : '#fff3cd'
            }; color: ${
                type === 'success' ? '#155724' : 
                type === 'error' ? '#721c24' : '#856404'
            }; border-radius: 5px;">${message}</div>`;
            
            setTimeout(() => {
                status.innerHTML = '';
            }, 3000);
        }

        // تحميل تلقائي إذا كان هناك بيانات
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('auto')) {
                loadFromLocal();
            }
        };
    </script>
</body>
          </html>
